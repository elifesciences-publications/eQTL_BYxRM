
#7/30/15
#eQTL1 SxaQSEQsVB100L6:KKHwuMHm 
#eQTL2 SxaQSEQsVB100L7:JcnasWvQ 

#7/31/15
#eQTL4  SxaQSEQsVB101L1:dlxbzKRH 
#eQTL5  SxaQSEQsVB101L2:NESeWaFM 
#eQTL6  SxaQSEQsVB101L3:lXVwGmRA
#eQTL7  SxaQSEQsVB101L4:DUJTqxg7 
#eQTL8  SxaQSEQsVB101L5:YXD6pNhA 
#eQTL9  SxaQSEQsVB101L6:lGAg6hBx
#eQTL10 SxaQSEQsVB101L7:7hYU2zdn 
#eQTL11 SxaQSEQsVB101L8:E2HMbB5W 

#9/17/15
#eQTL3   SxaQSEQsWB117L2:aeavGPns
#eQTL12  SxaQSEQsWB117L3:ltU8LhKN 
#eQTL13  SxaQSEQsWB117L4:Nhq44d3W 

# Repeat sequencing
#eQTL1   SxaQSEQsWB117L5:nD3ZGWNn 
#eQTL2   SxaQSEQsWB117L6:e4qPexws 
#eQTL4   SxaQSEQsWB117L7:P3FjBEmr 
#eQTL5   SxaQSEQsWB117L8:uMyEf9td 

eQTL6  SxaQSEQsVA093L1:dqh4ryxZ 
eQTL7  SxaQSEQsVA093L2:84fBkvjP 
eQTL8  SxaQSEQsVA093L3:ysBWtfgG
eQTL9  SxaQSEQsVA093L4:Uq3Velkz 
eQTL10 SxaQSEQsVA093L5:8tt3rU7C 
eQTL11 SxaQSEQsVA093L6:euuGeBeK 
 
eQTL3 SxaQSEQsXa091L1:yn6w3PWg 
eQTL12 SxaQSEQsVB103L1:vxXntz7B 
eQTL13 SxaQSEQsVB103L2:Ntt9uC3r 
#rsync --recursive --times --verbose --stats --progress --itemize-changes --sockopts=SO_RCVBUF=3145728,SO_SNDBUF=3145728 rsync://SxaQSEQsVB100L6@pan.pellegrini.mcdb.ucla.edu/SxaQSEQsVB100L6 /data/eQTL/qseq/eQTL1/SxaQSEQsVB100L6/
#rsync --recursive --times --verbose --stats --progress --itemize-changes --sockopts=SO_RCVBUF=3145728,SO_SNDBUF=3145728 rsync://SxaQSEQsVB100L7@pan.pellegrini.mcdb.ucla.edu/SxaQSEQsVB100L7 /data/eQTL/qseq/eQTL2/SxaQSEQsVB100L7/
#rsync --recursive --times --verbose --stats --progress --itemize-changes --sockopts=SO_RCVBUF=3145728,SO_SNDBUF=3145728 rsync://SxaQSEQsVB101L1@pan.pellegrini.mcdb.ucla.edu/SxaQSEQsVB101L1 /data/eQTL/qseq/eQTL4/SxaQSEQsVB101L1/
#rsync --recursive --times --verbose --stats --progress --itemize-changes --sockopts=SO_RCVBUF=3145728,SO_SNDBUF=3145728 rsync://SxaQSEQsVB101L2@pan.pellegrini.mcdb.ucla.edu/SxaQSEQsVB101L2 /data/eQTL/qseq/eQTL5/SxaQSEQsVB101L2/
#rsync --recursive --times --verbose --stats --progress --itemize-changes --sockopts=SO_RCVBUF=3145728,SO_SNDBUF=3145728 rsync://SxaQSEQsVB101L3@pan.pellegrini.mcdb.ucla.edu/SxaQSEQsVB101L3 /data/eQTL/qseq/eQTL6/SxaQSEQsVB101L3/
#rsync --recursive --times --verbose --stats --progress --itemize-changes --sockopts=SO_RCVBUF=3145728,SO_SNDBUF=3145728 rsync://SxaQSEQsVB101L4@pan.pellegrini.mcdb.ucla.edu/SxaQSEQsVB101L4 /data/eQTL/qseq/eQTL7/SxaQSEQsVB101L4/
#rsync --recursive --times --verbose --stats --progress --itemize-changes --sockopts=SO_RCVBUF=3145728,SO_SNDBUF=3145728 rsync://SxaQSEQsVB101L5@pan.pellegrini.mcdb.ucla.edu/SxaQSEQsVB101L5 /data/eQTL/qseq/eQTL8/SxaQSEQsVB101L5/
#rsync --recursive --times --verbose --stats --progress --itemize-changes --sockopts=SO_RCVBUF=3145728,SO_SNDBUF=3145728 rsync://SxaQSEQsVB101L6@pan.pellegrini.mcdb.ucla.edu/SxaQSEQsVB101L6 /data/eQTL/qseq/eQTL9/SxaQSEQsVB101L6/
#rsync --recursive --times --verbose --stats --progress --itemize-changes --sockopts=SO_RCVBUF=3145728,SO_SNDBUF=3145728 rsync://SxaQSEQsVB101L7@pan.pellegrini.mcdb.ucla.edu/SxaQSEQsVB101L7 /data/eQTL/qseq/eQTL10/SxaQSEQsVB101L7/
#rsync --recursive --times --verbose --stats --progress --itemize-changes --sockopts=SO_RCVBUF=3145728,SO_SNDBUF=3145728 rsync://SxaQSEQsVB101L8@pan.pellegrini.mcdb.ucla.edu/SxaQSEQsVB101L8 /data/eQTL/qseq/eQTL11/SxaQSEQsVB101L8/

#rsync --recursive --times --verbose --stats --progress --itemize-changes --sockopts=SO_RCVBUF=3145728,SO_SNDBUF=3145728 rsync://SxaQSEQsWB117L2@pan.pellegrini.mcdb.ucla.edu/SxaQSEQsWB117L2 /data/eQTL/qseq/eQTL3/SxaQSEQsWB117L2/
#rsync --recursive --times --verbose --stats --progress --itemize-changes --sockopts=SO_RCVBUF=3145728,SO_SNDBUF=3145728 rsync://SxaQSEQsWB117L3@pan.pellegrini.mcdb.ucla.edu/SxaQSEQsWB117L3 /data/eQTL/qseq/eQTL12/SxaQSEQsWB117L3/
#rsync --recursive --times --verbose --stats --progress --itemize-changes --sockopts=SO_RCVBUF=3145728,SO_SNDBUF=3145728 rsync://SxaQSEQsWB117L4@pan.pellegrini.mcdb.ucla.edu/SxaQSEQsWB117L4 /data/eQTL/qseq/eQTL13/SxaQSEQsWB117L4/

#rsync --recursive --times --verbose --stats --progress --itemize-changes --sockopts=SO_RCVBUF=3145728,SO_SNDBUF=3145728 rsync://SxaQSEQsWB117L5@pan.pellegrini.mcdb.ucla.edu/SxaQSEQsWB117L5 /data/eQTL/qseq/eQTL1/SxaQSEQsWB117L5/
#rsync --recursive --times --verbose --stats --progress --itemize-changes --sockopts=SO_RCVBUF=3145728,SO_SNDBUF=3145728 rsync://SxaQSEQsWB117L6@pan.pellegrini.mcdb.ucla.edu/SxaQSEQsWB117L6 /data/eQTL/qseq/eQTL2/SxaQSEQsWB117L6/
#rsync --recursive --times --verbose --stats --progress --itemize-changes --sockopts=SO_RCVBUF=3145728,SO_SNDBUF=3145728 rsync://SxaQSEQsWB117L7@pan.pellegrini.mcdb.ucla.edu/SxaQSEQsWB117L7 /data/eQTL/qseq/eQTL4/SxaQSEQsWB117L7/
#rsync --recursive --times --verbose --stats --progress --itemize-changes --sockopts=SO_RCVBUF=3145728,SO_SNDBUF=3145728 rsync://SxaQSEQsWB117L8@pan.pellegrini.mcdb.ucla.edu/SxaQSEQsWB117L8 /data/eQTL/qseq/eQTL5/SxaQSEQsWB117L8/

#rsync --recursive --times --verbose --stats --progress --itemize-changes --sockopts=SO_RCVBUF=3145728,SO_SNDBUF=3145728 rsync://SxaQSEQsVA093L1@pan.pellegrini.mcdb.ucla.edu/SxaQSEQsVA093L1 /data/eQTL/qseq/eQTL6/SxaQSEQsVA093L1/
#rsync --recursive --times --verbose --stats --progress --itemize-changes --sockopts=SO_RCVBUF=3145728,SO_SNDBUF=3145728 rsync://SxaQSEQsVA093L2@pan.pellegrini.mcdb.ucla.edu/SxaQSEQsVA093L2 /data/eQTL/qseq/eQTL7/SxaQSEQsVA093L2/
#rsync --recursive --times --verbose --stats --progress --itemize-changes --sockopts=SO_RCVBUF=3145728,SO_SNDBUF=3145728 rsync://SxaQSEQsVA093L3@pan.pellegrini.mcdb.ucla.edu/SxaQSEQsVA093L3 /data/eQTL/qseq/eQTL8/SxaQSEQsVA093L3/
rsync --recursive --times --verbose --stats --progress --itemize-changes --sockopts=SO_RCVBUF=3145728,SO_SNDBUF=3145728 rsync://SxaQSEQsVA093L4@pan.pellegrini.mcdb.ucla.edu/SxaQSEQsVA093L4 /data/eQTL/qseq/eQTL9/SxaQSEQsVA093L4/
#rsync --recursive --times --verbose --stats --progress --itemize-changes --sockopts=SO_RCVBUF=3145728,SO_SNDBUF=3145728 rsync://SxaQSEQsVA093L5@pan.pellegrini.mcdb.ucla.edu/SxaQSEQsVA093L5 /data/eQTL/qseq/eQTL10/SxaQSEQsVA093L5/
#rsync --recursive --times --verbose --stats --progress --itemize-changes --sockopts=SO_RCVBUF=3145728,SO_SNDBUF=3145728 rsync://SxaQSEQsVA093L6@pan.pellegrini.mcdb.ucla.edu/SxaQSEQsVA093L6 /data/eQTL/qseq/eQTL11/SxaQSEQsVA093L6/

rsync --recursive --times --verbose --stats --progress --itemize-changes --sockopts=SO_RCVBUF=3145728,SO_SNDBUF=3145728 rsync://SxaQSEQsXa091L1@pan.pellegrini.mcdb.ucla.edu/SxaQSEQsXa091L1 /data/eQTL/qseq/eQTL3/SxaQSEQsXa091L1/
rsync --recursive --times --verbose --stats --progress --itemize-changes --sockopts=SO_RCVBUF=3145728,SO_SNDBUF=3145728 rsync://SxaQSEQsVB103L1@pan.pellegrini.mcdb.ucla.edu/SxaQSEQsVB103L1 /data/eQTL/qseq/eQTL12/SxaQSEQsVB103L1/
#rsync --recursive --times --verbose --stats --progress --itemize-changes --sockopts=SO_RCVBUF=3145728,SO_SNDBUF=3145728 rsync://SxaQSEQsVB103L2@pan.pellegrini.mcdb.ucla.edu/SxaQSEQsVB103L2 /data/eQTL/qseq/eQTL13/SxaQSEQsVB103L2/


#Batch='eQTL1'
#Lane='SxaQSEQsVB100L6'

#Batch='eQTL2'
#Lane='SxaQSEQsVB100L7'

#Batch='eQTL4'
#Lane='SxaQSEQsVB101L1'

#Batch='eQTL5'
#Lane='SxaQSEQsVB101L2'

#Batch='eQTL6'
#Lane='SxaQSEQsVB101L3'

#Batch='eQTL7'
#Lane='SxaQSEQsVB101L4'

#Batch='eQTL8'
#Lane='SxaQSEQsVB101L5'

#Batch='eQTL9'
#Lane='SxaQSEQsVB101L6'

#Batch='eQTL10'
#Lane='SxaQSEQsVB101L7'

#Batch='eQTL11'
#Lane='SxaQSEQsVB101L8'

#Batch='eQTL3'
#Lane='SxaQSEQsWB117L2'

#Batch='eQTL12'  
#Lane='SxaQSEQsWB117L3'

#Batch='eQTL13'  
#Lane='SxaQSEQsWB117L4' 
#Batch='eQTL1'   
#Lane='SxaQSEQsWB117L5' 
#Batch='eQTL2'   
#Lane='SxaQSEQsWB117L6' 
#Batch='eQTL4'   
#Lane='SxaQSEQsWB117L7' 
#Batch='eQTL5'  
#Lane='SxaQSEQsWB117L8' 
#Batch='eQTL6'  
#Lane='SxaQSEQsVA093L1' 

#Batch='eQTL7'  
#Lane='SxaQSEQsVA093L2'
#Batch='eQTL8' 
#Lane='SxaQSEQsVA093L3'
#Batch='eQTL9' 
#Lane='SxaQSEQsVA093L4'
#Batch='eQTL10'
#Lane='SxaQSEQsVA093L5'
#Batch='eQTL11'
#Lane='SxaQSEQsVA093L6'

#Batch='eQTL12'
#Lane='SxaQSEQsVB103L1'
#:vxXntz7B 
#Batch='eQTL13'
#Lane='SxaQSEQsVB103L2'
#:Ntt9uC3r 

Batch='eQTL3'
Lane='SxaQSEQsXa091L1'


Basedir='/data/eQTL/qseq'
#Basedir='/eQTL/qseq'
N="${Lane:(-1)}"
INdir=${Basedir}/${Batch}/${Lane}
IN1=${N}_1
IN2=${N}_2
IN3=${N}_3
OUTfile1=
OUTfile1=${Basedir}/${Batch}/${Lane}_read1.fastq.gz
OUTfile2=${Basedir}/${Batch}/${Lane}_index1.fastq.gz
OUTfile3=${Basedir}/${Batch}/${Lane}_index2.fastq.gz


# note filter for reads_passed_filter is $11==1
(for IN in "${INdir}"/s_"${IN1}"*.txt.gz; do
   (echo '@@@' "Working on ${IN}...  $(date)") > /dev/stderr
   gunzip -c  "${IN}" | awk -F $'\t' 'BEGIN { serial=0; }           \
     { serial++; gsub(/\./,"N", $9);                                \
      if ($11==1) printf("@%s_%s_%s_%s_%09d_%s\n%s\n+\n%s\n",       \
       $2,$3,$4,$11,serial,$8, $9, $10); }'; done) | pigz > "${OUTfile1}" 
(echo '@@@' "Done.  $(date)") > /dev/stderr    

(for IN in "${INdir}"/s_"${IN2}"*.txt.gz; do
   (echo '@@@' "Working on ${IN}...  $(date)") > /dev/stderr
   gunzip -c  "${IN}" | awk -F $'\t' 'BEGIN { serial=0; }           \
     { serial++; gsub(/\./,"N", $9);                                \
      if ($11==1) printf("@%s_%s_%s_%s_%09d_%s\n%s\n+\n%s\n",       \
       $2,$3,$4,$11,serial,$8, $9, $10); }'; done) | pigz > "${OUTfile2}" 
(echo '@@@' "Done.  $(date)") > /dev/stderr  

(for IN in "${INdir}"/s_"${IN3}"*.txt.gz; do
   (echo '@@@' "Working on ${IN}...  $(date)") > /dev/stderr
   gunzip -c  "${IN}" | awk -F $'\t' 'BEGIN { serial=0; }           \
     { serial++; gsub(/\./,"N", $9);                                \
      if ($11==1) printf("@%s_%s_%s_%s_%09d_%s\n%s\n+\n%s\n",       \
       $2,$3,$4,$11,serial,$8, $9, $10); }'; done) | pigz>  "${OUTfile3}" 
(echo '@@@' "Done.  $(date)") > /dev/stderr  



# in qseq directory:
#zcat `ls | grep _2_` | wc -l 120534143

# after outputting gz fastq
#for f in `ls *I5.fq.gz`; do echo $f; zcat $f | wc -l; done;
# awk 'NR%2==0' test
# awk 'NR%2==1' test

